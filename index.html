<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¢ç©¶ç¯å¢ƒå› ç´ å¯¹æ¤ç‰©å…‰åˆä½œç”¨å¼ºåº¦çš„å½±å“</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e6f7ff 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .main-container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 35px;
            background: linear-gradient(135deg, #1e7e34, #34a853);
            color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(30, 126, 52, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
        }
        
        h1 {
            margin-bottom: 15px;
            font-size: 2.8em;
            position: relative;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.25em;
            opacity: 0.95;
            position: relative;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
        
        .container {
            display: grid;
            grid-template-columns: 450px 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .design-panel, .analysis-panel {
            background: rgba(255, 255, 255, 0.98);
            padding: 35px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }
        
        h2 {
            color: #1e7e34;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #c8e6c9;
            display: flex;
            align-items: center;
            position: relative;
            font-weight: 600;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, #34a853, #1e7e34);
        }
        
        h2 i {
            margin-right: 12px;
            background: linear-gradient(135deg, #34a853, #1e7e34);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-left: 5px solid #34a853;
            padding: 22px;
            margin-bottom: 30px;
            border-radius: 0 15px 15px 0;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(52, 168, 83, 0.2);
        }
        
        .info-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #34a853, #1e7e34);
        }
        
        .info-box h3 {
            color: #1e7e34;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .info-box ul {
            padding-left: 20px;
        }
        
        .info-box li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 5px;
        }
        
        .info-box li::before {
            content: 'â€¢';
            color: #34a853;
            font-weight: bold;
            position: absolute;
            left: -15px;
        }
        
        .material-list {
            background: linear-gradient(135deg, #f1f8e9, #e8f5e9);
            border: 2px solid #c8e6c9;
            border-radius: 15px;
            padding: 22px;
            margin-bottom: 30px;
            position: relative;
        }
        
        .material-list::before {
            content: 'ğŸ§ª';
            position: absolute;
            top: -18px;
            right: 25px;
            font-size: 28px;
            background: white;
            padding: 8px;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #c8e6c9;
        }
        
        .material-list h3 {
            color: #1e7e34;
            margin-bottom: 18px;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .material-category {
            margin-bottom: 20px;
        }
        
        .material-category h4 {
            color: #34a853;
            margin-bottom: 8px;
            font-size: 1.1em;
            padding-left: 12px;
            border-left: 4px solid #34a853;
            font-weight: 600;
        }
        
        .material-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .material-item {
            background: white;
            border: 1px solid #c8e6c9;
            border-radius: 10px;
            padding: 10px 16px;
            font-size: 0.95em;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            color: #2e7d32;
            font-weight: 500;
        }
        
        .material-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            border-color: #34a853;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
        }
        
        .control-group {
            margin: 25px 0;
        }
        
        label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: #1e7e34;
            font-size: 1.1em;
        }
        
        select, input[type="number"] {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #c8e6c9;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 15px;
            background: white;
            transition: all 0.3s;
            color: #333;
        }
        
        select:focus, input[type="number"]:focus {
            border-color: #34a853;
            box-shadow: 0 0 0 4px rgba(52, 168, 83, 0.1);
            outline: none;
        }
        
        .variable-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 15px 0;
        }
        
        .variable-option {
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }
        
        .variable-option:hover {
            border-color: #34a853;
            background: linear-gradient(135deg, #f1f8e9, #e8f5e9);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .variable-option.selected {
            border-color: #34a853;
            background: linear-gradient(135deg, #c8e6c9, #a5d6a7);
            box-shadow: 0 6px 15px rgba(52, 168, 83, 0.2);
        }
        
        .param-inputs {
            margin: 25px 0;
        }
        
        .param-input-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 14px;
            background: linear-gradient(135deg, #f1f8e9, #e8f5e9);
            border-radius: 10px;
            transition: all 0.3s;
            border: 1px solid rgba(200, 230, 201, 0.8);
        }
        
        .param-input-row:hover {
            transform: translateX(5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .param-input-row label {
            min-width: 120px;
            margin-bottom: 0;
            font-weight: 600;
            color: #2e7d32;
        }
        
        .param-input-row input {
            flex-grow: 1;
            margin-bottom: 0;
            padding: 12px;
        }
        
        .unit {
            margin-left: 10px;
            color: #666;
            font-weight: 600;
        }
        
        .apparatus-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
            max-height: 600px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .apparatus {
            border: 2px solid #c8e6c9;
            border-radius: 15px;
            padding: 22px;
            background: linear-gradient(135deg, #f1f8e9, #e8f5e9);
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }
        
        .apparatus:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
            border-color: #34a853;
        }
        
        .apparatus h4 {
            margin-bottom: 15px;
            color: #1e7e34;
            text-align: center;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .apparatus-visual {
            position: relative;
            height: 280px;
            margin: 15px 0;
            border-radius: 12px;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(200, 230, 201, 0.8);
        }
        
        /* å®éªŒè£…ç½®ç®€ç¬”ç”»æ ·å¼ */
        .experiment-setup {
            position: relative;
            width: 200px;
            height: 200px;
        }
        
        .beaker {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 140px;
            border: 3px solid #4a90e2;
            border-top: none;
            border-radius: 0 0 10px 10px;
            background: rgba(255, 255, 255, 0.8);
            overflow: hidden;
        }
        
        .beaker::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 70%;
            background: linear-gradient(to bottom, rgba(74, 144, 226, 0.2), rgba(74, 144, 226, 0.1));
            border-radius: 0 0 10px 10px;
        }
        
        .plant {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 40px;
            z-index: 2;
            color: #1e7e34;
            filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
            animation: plant-grow 3s infinite alternate;
        }
        
        @keyframes plant-grow {
            0% { transform: translateX(-50%) scale(1); }
            100% { transform: translateX(-50%) scale(1.05); }
        }
        
        .light-source {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 30px;
            background: linear-gradient(135deg, #ffcc00, #ff9900);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }
        
        .light-beam {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 0;
            background: linear-gradient(to bottom, rgba(255, 204, 0, 0.8), rgba(255, 153, 0, 0.3));
            transition: height 0.3s;
            z-index: 5;
        }
        
        .sensors {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 10;
        }
        
        .sensor {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #34a853, #1e7e34);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .data-line {
            position: absolute;
            right: 50px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 2px;
            background: #666;
        }
        
        .bubbles-container {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 100px;
        }
        
        .bubble {
            position: absolute;
            width: 10px;
            height: 10px;
            background: rgba(33, 150, 243, 0.8);
            border-radius: 50%;
            animation: bubble-rise 2s linear infinite;
            filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
        }
        
        @keyframes bubble-rise {
            0% {
                transform: translateY(0) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(1.2);
                opacity: 0;
            }
        }
        
        .apparatus-data {
            margin-top: 15px;
            text-align: center;
        }
        
        .data-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            border: 1px solid #e0f2e1;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05);
        }
        
        .data-label {
            font-weight: 600;
            color: #555;
        }
        
        .data-value {
            color: #1e7e34;
            font-weight: 700;
            font-size: 1.1em;
        }
        
        .button-group {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }
        
        button {
            background: linear-gradient(135deg, #34a853, #1e7e34);
            color: white;
            border: none;
            padding: 18px 32px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            box-shadow: 0 6px 15px rgba(52, 168, 83, 0.3);
            letter-spacing: 0.5px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(52, 168, 83, 0.4);
        }
        
        button:active {
            transform: translateY(-1px);
        }
        
        button i {
            margin-right: 10px;
            font-size: 18px;
        }
        
        button.reset {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            box-shadow: 0 6px 15px rgba(244, 67, 54, 0.3);
        }
        
        button.reset:hover {
            box-shadow: 0 10px 25px rgba(244, 67, 54, 0.4);
        }
        
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .time-control {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 25px 0;
            padding: 22px;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-radius: 15px;
            border: 2px solid #a5d6a7;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .time-display {
            font-weight: 700;
            color: #1e7e34;
            margin: 0 15px;
            font-size: 1.5em;
            background: white;
            padding: 12px 24px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            min-width: 100px;
            text-align: center;
        }
        
        .speed-control {
            margin-left: 30px;
            display: flex;
            align-items: center;
            background: white;
            padding: 12px 24px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .speed-control label {
            margin-right: 12px;
            margin-bottom: 0;
            font-weight: 600;
            color: #1e7e34;
        }
        
        .speed-control select {
            width: auto;
            margin-bottom: 0;
            padding: 10px 18px;
            font-weight: 600;
        }
        
        .charts-container {
            display: flex;
            flex-direction: column;
            gap: 40px;
            margin-top: 30px;
        }
        
        .chart-section {
            background: white;
            border-radius: 18px;
            padding: 28px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.4em;
            font-weight: 700;
            color: #1e7e34;
            padding-bottom: 18px;
            border-bottom: 2px solid #c8e6c9;
        }
        
        .chart-container {
            height: 420px;
            position: relative;
        }
        
        .chart-placeholder {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: #888;
            font-style: italic;
            font-size: 1.2em;
            background: linear-gradient(135deg, #f9f9f9, #f0f0f0);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .real-time-legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            padding: 18px;
            background: linear-gradient(135deg, #f1f8e9, #e8f5e9);
            border-radius: 15px;
            border: 1px solid #c8e6c9;
        }
        
        .legend-item {
            display: inline-flex;
            align-items: center;
            margin-right: 15px;
            margin-bottom: 5px;
            padding: 10px 18px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0f2e1;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            margin-right: 10px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        }
        
        footer {
            margin-top: 50px;
            text-align: center;
            color: #666;
            font-size: 0.95em;
            padding-top: 30px;
            border-top: 1px solid #e0e0e0;
        }
        
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .apparatus-container {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <header>
            <h1>æ¢ç©¶ç¯å¢ƒå› ç´ å¯¹æ¤ç‰©å…‰åˆä½œç”¨å¼ºåº¦çš„å½±å“</h1>
            <p class="subtitle">è‡ªä¸»è®¾è®¡å®éªŒ Â· å®æ—¶æ•°æ®ç›‘æµ‹ Â· å¤šç»´åº¦æ•°æ®åˆ†æ</p>
        </header>
        
        <div class="container">
            <div class="design-panel">
                <h2><i class="fas fa-flask"></i> å®éªŒè®¾è®¡</h2>
                
                <div class="material-list">
                    <h3><i class="fas fa-vial"></i> å®éªŒææ–™</h3>
                    <div class="material-category">
                        <h4><i class="fas fa-seedling"></i> ç”Ÿç‰©ææ–™</h4>
                        <div class="material-items">
                            <span class="material-item">é»‘è—»</span>
                            <span class="material-item">ç¢³é…¸æ°¢é’ æº¶æ¶²</span>
                            <span class="material-item">è’¸é¦æ°´</span>
                            <span class="material-item">pHç¼“å†²æ¶²</span>
                        </div>
                    </div>
                    <div class="material-category">
                        <h4><i class="fas fa-lightbulb"></i> å…‰æºè®¾å¤‡</h4>
                        <div class="material-items">
                            <span class="material-item">å¯è°ƒå…‰å¼ºLEDç¯</span>
                            <span class="material-item">çº¢å…‰LEDç¯ (660nm)</span>
                            <span class="material-item">è“å…‰LEDç¯ (450nm)</span>
                            <span class="material-item">ç™½å…‰LEDç¯</span>
                        </div>
                    </div>
                    <div class="material-category">
                        <h4><i class="fas fa-microscope"></i> æ£€æµ‹ä»ªå™¨</h4>
                        <div class="material-items">
                            <span class="material-item">æ°§æ°”ä¼ æ„Ÿå™¨</span>
                            <span class="material-item">pHä¼ æ„Ÿå™¨</span>
                            <span class="material-item">æ•°æ®é‡‡é›†å™¨</span>
                            <span class="material-item">å¯†é—­é€æ˜ååº”å®¤</span>
                        </div>
                    </div>
                    <div class="material-category">
                        <h4><i class="fas fa-tools"></i> å®éªŒå™¨æ</h4>
                        <div class="material-items">
                            <span class="material-item">å¯†é—­ååº”å®¤</span>
                            <span class="material-item">çƒ§æ¯</span>
                            <span class="material-item">æ¸©åº¦æ§åˆ¶å™¨</span>
                            <span class="material-item">ç£åŠ›æ…æ‹Œå™¨</span>
                        </div>
                    </div>
                </div>
                
                <div class="info-box">
                    <h3><i class="fas fa-chart-line"></i> å®éªŒå‚æ•°å‚è€ƒèŒƒå›´</h3>
                    <ul>
                        <li><strong>å…‰å¼ºåº¦</strong>: å…‰åˆä½œç”¨æœ‰æ•ˆèŒƒå›´ 1000-120000 lux</li>
                        <li><strong>æ¸©åº¦</strong>: å…‰åˆä½œç”¨é€‚å®œæ¸©åº¦ 15-35Â°Cï¼Œæœ€é€‚æ¸©åº¦ 25-30Â°C</li>
                        <li><strong>ç¢³é…¸æ°¢é’ æµ“åº¦</strong>: å¸¸ç”¨æµ“åº¦ 0.1-2.0% (w/v)ï¼Œå¯¹åº”COâ‚‚é‡Šæ”¾é‡ 200-2000 ppm</li>
                        <li><strong>pHå€¼</strong>: å…‰åˆä½œç”¨é€‚å®œpH 6.0-8.0ï¼Œæœ€é€‚pH 7.0-7.5</li>
                        <li><strong>å…‰çš„æ³¢é•¿</strong>: å¯è§å…‰èŒƒå›´ 400-700 nmï¼Œå…‰åˆä½œç”¨æœ‰æ•ˆå…‰: çº¢å…‰(620-750 nm)ï¼Œè“å…‰(450-495 nm)</li>
                        <li><strong>å®éªŒæ—¶é•¿</strong>: å…‰åˆä½œç”¨è§‚å¯Ÿé€šå¸¸ 5-30 åˆ†é’Ÿ</li>
                    </ul>
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-sliders-h"></i> 1. é€‰æ‹©è‡ªå˜é‡ï¼š</label>
                    <select id="independentVar">
                        <option value="light">å…‰å¼ºåº¦ (lux)</option>
                        <option value="temperature">æ¸©åº¦ (Â°C)</option>
                        <option value="nahco3">ç¢³é…¸æ°¢é’ æº¶æ¶²æµ“åº¦ (%)</option>
                        <option value="ph">pHå€¼</option>
                        <option value="wavelength">å…‰çš„æ³¢é•¿ (nm)</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-chart-bar"></i> 2. é€‰æ‹©åº”å˜é‡ï¼š</label>
                    <div class="variable-options">
                        <div class="variable-option selected" data-value="oxygen-concentration">
                            <div>æ°§æ°”æµ“åº¦</div>
                            <div style="font-size:0.9em;color:#666;">ppm</div>
                        </div>
                        <div class="variable-option" data-value="oxygen-rate">
                            <div>æ°§æ°”é‡Šæ”¾é€Ÿç‡</div>
                            <div style="font-size:0.9em;color:#666;">mL/h</div>
                        </div>
                        <div class="variable-option" data-value="co2-rate">
                            <div>äºŒæ°§åŒ–ç¢³å¸æ”¶é€Ÿç‡</div>
                            <div style="font-size:0.9em;color:#666;">Î¼mol/mÂ²/s</div>
                        </div>
                    </div>
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-layer-group"></i> 3. è®¾ç½®å®éªŒç»„æ•°ï¼š</label>
                    <input type="number" id="groupCount" min="2" max="10" value="3" onchange="generateParamInputs()">
                </div>
                
                <div class="control-group">
                    <div id="paramInputs" class="param-inputs">
                        <!-- å‚æ•°è¾“å…¥æ¡†å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-clock"></i> 5. è®¾ç½®å…‰åˆä½œç”¨æ—¶é•¿ï¼š</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" id="experimentDuration" min="1" max="60" value="10" style="width: 100px;">
                        <span style="font-weight: bold; color: #1e7e34;">åˆ†é’Ÿ</span>
                    </div>
                    <div style="margin-top: 5px; font-size: 0.9em; color: #666;">
                        <i>æç¤ºï¼šå®éªŒæ—¶é•¿å†³å®šæ•°æ®é‡‡é›†çš„æ—¶é—´èŒƒå›´</i>
                    </div>
                </div>
                
                <button onclick="generateApparatus()"><i class="fas fa-cogs"></i> ç”Ÿæˆå®éªŒè£…ç½®</button>
                
                <div id="apparatusSection" style="display:none;">
                    <h3 style="margin-top:30px; color: #1e7e34;"><i class="fas fa-vial"></i> å®éªŒè£…ç½®</h3>
                    <div id="apparatusContainer" class="apparatus-container">
                        <!-- å®éªŒè£…ç½®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
            
            <div class="analysis-panel">
                <h2><i class="fas fa-chart-pie"></i> æ•°æ®åˆ†æ</h2>
                
                <div class="button-group">
                    <button onclick="startExperiment()" id="startBtn"><i class="fas fa-play"></i> å¼€å§‹å®éªŒ</button>
                    <button onclick="recordData()" id="recordBtn" disabled><i class="fas fa-table"></i> æ•°æ®æ•´ç†</button>
                    <button onclick="resetExperiment()" class="reset"><i class="fas fa-redo"></i> é‡ç½®å®éªŒ</button>
                </div>
                
                <div class="time-control">
                    <span style="font-weight: bold; color: #1e7e34;">å®éªŒæ—¶é—´:</span>
                    <span id="timeDisplay" class="time-display">0:00</span>
                    <div class="speed-control">
                        <label style="font-weight: bold; color: #1e7e34;">æ¨¡æ‹Ÿé€Ÿåº¦:</label>
                        <select id="speedControl" onchange="changeSpeed()">
                            <option value="1">1Ã— å®æ—¶</option>
                            <option value="2" selected>2Ã— åŠ é€Ÿ</option>
                            <option value="5">5Ã— å¿«é€Ÿ</option>
                            <option value="10">10Ã— æé€Ÿ</option>
                        </select>
                    </div>
                </div>
                
                <div class="charts-container">
                    <div class="chart-section">
                        <div class="chart-title"><i class="fas fa-chart-line"></i> å®æ—¶ç›‘æµ‹æ›²çº¿ - åº”å˜é‡éšæ—¶é—´å˜åŒ–</div>
                        <div class="chart-container">
                            <canvas id="realTimeChart"></canvas>
                            <div id="realTimePlaceholder" class="chart-placeholder">
                                ç‚¹å‡»"å¼€å§‹å®éªŒ"åï¼Œå°†æ˜¾ç¤ºå®æ—¶ç›‘æµ‹æ•°æ®
                            </div>
                        </div>
                        <div id="realTimeLegend" class="real-time-legend"></div>
                    </div>
                    
                    <div class="chart-section">
                        <div class="chart-title"><i class="fas fa-chart-bar"></i> æ•°æ®åˆ†ææŸ±çŠ¶å›¾ - è‡ªå˜é‡å¯¹åº”å˜é‡å½±å“</div>
                        <div class="chart-container">
                            <canvas id="barChart"></canvas>
                            <div id="barChartPlaceholder" class="chart-placeholder">
                                è®°å½•æ•°æ®åï¼Œå°†æ˜¾ç¤ºå„å®éªŒç»„ç»“æœå¯¹æ¯”
                            </div>
                        </div>
                    </div>
                    
                    <div id="lineChartSection" class="chart-section" style="display: none;">
                        <div class="chart-title"><i class="fas fa-chart-line"></i> è‡ªå˜é‡ä¸åº”å˜é‡å…³ç³»æŠ˜çº¿å›¾</div>
                        <div class="chart-container">
                            <canvas id="lineChart"></canvas>
                            <div id="lineChartPlaceholder" class="chart-placeholder">
                                å½“å®éªŒç»„æ•°â‰¥5æ—¶ï¼Œå°†æ˜¾ç¤ºæŠ˜çº¿å›¾åˆ†æ
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>é«˜ä¸­ç”Ÿç‰©æ¢ç©¶å®éªŒ Â· å…‰åˆä½œç”¨å½±å“å› ç´ æ¨¡æ‹Ÿ Â· åŸºäºç§‘å­¦æ¨¡å‹è®¡ç®—</p>
            <p>è®¾è®¡ç”¨äºå¸®åŠ©å­¦ç”Ÿç†è§£å®éªŒè®¾è®¡ã€å˜é‡æ§åˆ¶å’Œæ•°æ®åˆ†æ</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // å…¨å±€å˜é‡
        let experimentRunning = false;
        let experimentTime = 0; // å•ä½ï¼šç§’
        let timeInterval;
        let simulationSpeed = 2; // é»˜è®¤2å€é€Ÿ
        let experimentGroups = [];
        let recordedData = [];
        let realTimeChart, barChart, lineChart;
        let maxExperimentTime = 600; // é»˜è®¤10åˆ†é’Ÿï¼ˆ600ç§’ï¼‰
        
        // ç¯å¢ƒå‚è€ƒæ•°æ®
        const envData = {
            light: {
                min: 1000,
                max: 120000,
                unit: "lux",
                description: "å…‰å¼ºåº¦èŒƒå›´",
                suggestions: [5000, 15000, 30000, 50000, 80000, 100000]
            },
            temperature: {
                min: 15,
                max: 35,
                unit: "Â°C",
                description: "æ¸©åº¦èŒƒå›´",
                suggestions: [18, 22, 25, 28, 32, 35]
            },
            nahco3: {
                min: 0.1,
                max: 2.0,
                unit: "%",
                description: "ç¢³é…¸æ°¢é’ æº¶æ¶²æµ“åº¦èŒƒå›´",
                suggestions: [0.2, 0.5, 0.8, 1.0, 1.5, 2.0]
            },
            ph: {
                min: 6.0,
                max: 8.0,
                unit: "",
                description: "pHå€¼èŒƒå›´",
                suggestions: [6.0, 6.5, 7.0, 7.5, 8.0]
            },
            wavelength: {
                min: 400,
                max: 700,
                unit: "nm",
                description: "å…‰çš„æ³¢é•¿èŒƒå›´",
                suggestions: [420, 450, 500, 550, 600, 650, 680, 700],
                colors: {
                    420: '#3f51b5', // è“ç´«å…‰
                    450: '#2196f3', // è“å…‰
                    500: '#4caf50', // ç»¿å…‰
                    550: '#8bc34a', // é»„ç»¿å…‰
                    600: '#ff9800', // æ©™å…‰
                    650: '#ff5722', // çº¢å…‰
                    680: '#f44336', // æ·±çº¢å…‰
                    700: '#d32f2f'  // è¿œçº¢å…‰
                }
            }
        };
        
        // é¢œè‰²æ–¹æ¡ˆ - æ›´ç°ä»£ã€æ¸…æ™°
        const chartColors = [
            '#34a853', '#4285f4', '#ea4335', '#fbbc04', '#8e44ad', 
            '#00bcd4', '#ff9800', '#9c27b0', '#3f51b5', '#009688'
        ];
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // åº”å˜é‡é€‰é¡¹ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.variable-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.variable-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });
            
            // å®éªŒæ—¶é•¿å˜åŒ–äº‹ä»¶
            document.getElementById('experimentDuration').addEventListener('change', function() {
                maxExperimentTime = parseInt(this.value) * 60; // è½¬æ¢ä¸ºç§’
            });
            
            // ç”Ÿæˆå‚æ•°è¾“å…¥æ¡†
            generateParamInputs();
        });
        
        // ç”Ÿæˆå‚æ•°è¾“å…¥æ¡†
        function generateParamInputs() {
            const independentVar = document.getElementById('independentVar').value;
            const groupCount = parseInt(document.getElementById('groupCount').value);
            const paramInputsDiv = document.getElementById('paramInputs');
            
            paramInputsDiv.innerHTML = '<h4 style="color: #1e7e34; margin-bottom: 15px;"><i class="fas fa-sliders-h"></i> 4. è®¾ç½®å„å®éªŒç»„å‚æ•°ï¼š</h4>';
            
            const varInfo = envData[independentVar];
            
            for (let i = 1; i <= groupCount; i++) {
                const suggestion = varInfo.suggestions[i-1] || 
                    Math.round(varInfo.min + (i-1) * (varInfo.max - varInfo.min) / (groupCount - 1) * 100) / 100;
                
                const row = document.createElement('div');
                row.className = 'param-input-row';
                
                if (independentVar === 'wavelength') {
                    row.innerHTML = `
                        <label>å®éªŒç»„ ${i}:</label>
                        <input type="number" id="param${i}" min="${varInfo.min}" max="${varInfo.max}" value="${suggestion}" step="10">
                        <span class="unit">${varInfo.unit}</span>
                        <span id="wavelengthColor${i}" style="width:24px;height:24px;border-radius:50%;margin-left:10px;display:inline-block;border:2px solid white;box-shadow:0 3px 6px rgba(0,0,0,0.2);"></span>
                    `;
                } else {
                    const step = independentVar === 'nahco3' ? 0.1 : (independentVar === 'temperature' ? 0.5 : (independentVar === 'ph' ? 0.1 : 1));
                    row.innerHTML = `
                        <label>å®éªŒç»„ ${i}:</label>
                        <input type="number" id="param${i}" min="${varInfo.min}" max="${varInfo.max}" value="${suggestion}" step="${step}">
                        <span class="unit">${independentVar === 'ph' ? '' : varInfo.unit}</span>
                    `;
                }
                
                paramInputsDiv.appendChild(row);
            }
            
            // æ›´æ–°æ³¢é•¿é¢œè‰²æ˜¾ç¤º
            if (independentVar === 'wavelength') {
                updateWavelengthColors();
            }
        }
        
        // æ›´æ–°æ³¢é•¿é¢œè‰²æ˜¾ç¤º
        function updateWavelengthColors() {
            const groupCount = parseInt(document.getElementById('groupCount').value);
            for (let i = 1; i <= groupCount; i++) {
                const value = document.getElementById(`param${i}`).value;
                const colorElement = document.getElementById(`wavelengthColor${i}`);
                if (colorElement) {
                    const color = getWavelengthColor(value);
                    colorElement.style.backgroundColor = color;
                    colorElement.title = getWavelengthName(value);
                }
            }
        }
        
        // æ ¹æ®æ³¢é•¿è·å–é¢œè‰²
        function getWavelengthColor(wavelength) {
            const w = parseInt(wavelength);
            if (w <= 440) return '#3f51b5'; // è“ç´«å…‰
            if (w <= 490) return '#2196f3'; // è“å…‰
            if (w <= 520) return '#4caf50'; // ç»¿å…‰
            if (w <= 570) return '#8bc34a'; // é»„ç»¿å…‰
            if (w <= 590) return '#ffeb3b'; // é»„å…‰
            if (w <= 620) return '#ff9800'; // æ©™å…‰
            if (w <= 670) return '#ff5722'; // çº¢å…‰
            return '#d32f2f'; // æ·±çº¢å…‰
        }
        
        // æ ¹æ®æ³¢é•¿è·å–åç§°
        function getWavelengthName(wavelength) {
            const w = parseInt(wavelength);
            if (w <= 440) return 'è“ç´«å…‰';
            if (w <= 490) return 'è“å…‰';
            if (w <= 520) return 'ç»¿å…‰';
            if (w <= 570) return 'é»„ç»¿å…‰';
            if (w <= 590) return 'é»„å…‰';
            if (w <= 620) return 'æ©™å…‰';
            if (w <= 670) return 'çº¢å…‰';
            return 'æ·±çº¢å…‰';
        }
        
        // ç”Ÿæˆå®éªŒè£…ç½®
        function generateApparatus() {
            const independentVar = document.getElementById('independentVar').value;
            const groupCount = parseInt(document.getElementById('groupCount').value);
            const apparatusSection = document.getElementById('apparatusSection');
            const apparatusContainer = document.getElementById('apparatusContainer');
            
            apparatusContainer.innerHTML = '';
            experimentGroups = [];
            
            // å¯ç”¨å¼€å§‹å®éªŒæŒ‰é’®
            document.getElementById('startBtn').disabled = false;
            
            for (let i = 1; i <= groupCount; i++) {
                const paramValue = document.getElementById(`param${i}`).value;
                
                // åˆ›å»ºå®éªŒç»„å¯¹è±¡
                const group = {
                    id: i,
                    independentVar: independentVar,
                    independentValue: parseFloat(paramValue),
                    initialO2Concentration: 210000, // åˆå§‹æ°§æ°”æµ“åº¦ (ppm, çº¦21%)
                    initialCO2Concentration: 400,   // åˆå§‹äºŒæ°§åŒ–ç¢³æµ“åº¦ (ppm)
                    currentO2Concentration: 210000,
                    currentCO2Concentration: 400,
                    oxygenRate: 0,
                    co2Rate: 0,
                    timeData: [],
                    o2ConcentrationData: [],
                    co2ConcentrationData: [],
                    oxygenRateData: [],
                    co2RateData: []
                };
                experimentGroups.push(group);
                
                // åˆ›å»ºå®éªŒè£…ç½®å¯è§†åŒ–
                const apparatus = document.createElement('div');
                apparatus.className = 'apparatus';
                
                let lightBeamHeight = 0;
                let lightColor = '#ffcc00';
                let lightIntensity = 1;
                
                // æ ¹æ®è‡ªå˜é‡ç±»å‹è®¾ç½®ä¸åŒçš„è§†è§‰æ•ˆæœ
                if (independentVar === 'light') {
                    lightIntensity = Math.min(1, paramValue / 120000);
                    lightBeamHeight = 80 * lightIntensity;
                    lightColor = `rgb(${255 - (lightIntensity * 100)}, ${204 - (lightIntensity * 50)}, ${0})`;
                } else if (independentVar === 'wavelength') {
                    lightColor = getWavelengthColor(paramValue);
                    lightBeamHeight = 80;
                } else {
                    lightBeamHeight = 80;
                }
                
                apparatus.innerHTML = `
                    <h4>å®éªŒç»„ ${i}</h4>
                    <div class="apparatus-visual">
                        <div class="experiment-setup">
                            <div class="beaker"></div>
                            <div class="plant">ğŸŒ¿</div>
                            <div class="light-source" style="background: linear-gradient(135deg, ${lightColor}, ${lightColor}dd)">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="light-beam" style="height: ${lightBeamHeight}px; background: linear-gradient(to bottom, ${lightColor}cc, ${lightColor}33)"></div>
                            <div class="sensors">
                                <div class="sensor" title="æ°§æ°”ä¼ æ„Ÿå™¨">
                                    <i class="fas fa-wind"></i>
                                </div>
                                <div class="sensor" title="pHä¼ æ„Ÿå™¨">
                                    <i class="fas fa-tint"></i>
                                </div>
                            </div>
                            <div class="data-line"></div>
                            <div class="bubbles-container" id="bubbles${i}">
                                <!-- æ°”æ³¡å°†é€šè¿‡JSç”Ÿæˆ -->
                            </div>
                        </div>
                    </div>
                    <div class="apparatus-data">
                        <div class="data-item">
                            <span class="data-label">${getVarName(independentVar)}:</span>
                            <span class="data-value">${paramValue}${getVarUnit(independentVar)}</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label" id="dependentLabel${i}">${getDependentName()}:</span>
                            <span class="data-value" id="reading${i}">${getInitialDependentValue()}</span>
                        </div>
                    </div>
                `;
                apparatusContainer.appendChild(apparatus);
            }
            
            apparatusSection.style.display = 'block';
            
            // å¯ç”¨è®°å½•æŒ‰é’®
            document.getElementById('recordBtn').disabled = false;
        }
        
        // è·å–å˜é‡åç§°
        function getVarName(varType) {
            switch(varType) {
                case 'light': return 'å…‰å¼ºåº¦';
                case 'temperature': return 'æ¸©åº¦';
                case 'nahco3': return 'ç¢³é…¸æ°¢é’ æµ“åº¦';
                case 'ph': return 'pHå€¼';
                case 'wavelength': return 'å…‰çš„æ³¢é•¿';
                default: return '';
            }
        }
        
        // è·å–å˜é‡å•ä½
        function getVarUnit(varType) {
            switch(varType) {
                case 'light': return ' lux';
                case 'temperature': return 'Â°C';
                case 'nahco3': return ' %';
                case 'ph': return '';
                case 'wavelength': return ' nm';
                default: return '';
            }
        }
        
        // è·å–åº”å˜é‡å•ä½
        function getDependentUnit() {
            const selectedOption = document.querySelector('.variable-option.selected');
            const value = selectedOption.dataset.value;
            
            switch(value) {
                case 'oxygen-concentration': return ' ppm';
                case 'oxygen-rate': return ' mL/h';
                case 'co2-rate': return ' Î¼mol/mÂ²/s';
                default: return '';
            }
        }
        
        // è·å–åº”å˜é‡åç§°
        function getDependentName() {
            const selectedOption = document.querySelector('.variable-option.selected');
            const value = selectedOption.dataset.value;
            
            switch(value) {
                case 'oxygen-concentration': return 'æ°§æ°”æµ“åº¦';
                case 'oxygen-rate': return 'æ°§æ°”é‡Šæ”¾é€Ÿç‡';
                case 'co2-rate': return 'äºŒæ°§åŒ–ç¢³å¸æ”¶é€Ÿç‡';
                default: return '';
            }
        }
        
        // è·å–åº”å˜é‡ç±»å‹
        function getDependentType() {
            const selectedOption = document.querySelector('.variable-option.selected');
            return selectedOption.dataset.value;
        }
        
        // è·å–åˆå§‹åº”å˜é‡å€¼
        function getInitialDependentValue() {
            const type = getDependentType();
            
            switch(type) {
                case 'oxygen-concentration': return '210000';
                case 'oxygen-rate': return '0.00';
                case 'co2-rate': return '0.00';
                default: return '0.00';
            }
        }
        
        // è®¡ç®—å…‰åˆä½œç”¨é€Ÿç‡ï¼ˆç®€åŒ–æ¨¡å‹ï¼‰
        function calculatePhotosynthesisRates(group) {
            const independentVar = group.independentVar;
            const independentValue = group.independentValue;
            
            // å‡è®¾å…¶ä»–å˜é‡ä¿æŒæ’å®š
            const light = independentVar === 'light' ? independentValue : 50000;
            const temp = independentVar === 'temperature' ? independentValue : 25;
            const nahco3 = independentVar === 'nahco3' ? independentValue : 0.8;
            const ph = independentVar === 'ph' ? independentValue : 7.0;
            const wavelength = independentVar === 'wavelength' ? independentValue : 550;
            
            // ç¢³é…¸æ°¢é’ æµ“åº¦è½¬æ¢ä¸ºCOâ‚‚å¯ç”¨æ€§
            const co2Availability = nahco3 / 2.0; // å‡è®¾2%ä¸ºæœ€å¤§COâ‚‚ä¾›åº”
            
            // pHå½±å“ï¼ˆé’Ÿå½¢æ›²çº¿ï¼Œæœ€é€‚pH 7.0ï¼‰
            const phDiff = Math.abs(ph - 7.0);
            const phEffect = Math.exp(-0.5 * phDiff * phDiff);
            
            // å…‰å¼ºå½±å“ï¼ˆç±³æ°æ–¹ç¨‹ç®€åŒ–ï¼‰
            const lightEffect = light / (2000 + light);
            
            // æ¸©åº¦å½±å“ï¼ˆé’Ÿå½¢æ›²çº¿ï¼Œæœ€é€‚æ¸©åº¦25Â°Cï¼‰
            const tempDiff = Math.abs(temp - 25);
            const tempEffect = Math.exp(-0.015 * tempDiff * tempDiff);
            
            // COâ‚‚å½±å“ï¼ˆåŸºäºç¢³é…¸æ°¢é’ æµ“åº¦ï¼‰
            const co2Effect = co2Availability / (0.5 + co2Availability);
            
            // æ³¢é•¿å½±å“ï¼ˆå…‰åˆä½œç”¨æ•ˆç‡æ›²çº¿ï¼‰
            let wavelengthEffect;
            if (wavelength <= 440) {
                wavelengthEffect = 0.4 + 0.3 * (wavelength - 400) / 40;
            } else if (wavelength <= 490) {
                wavelengthEffect = 0.7 + 0.2 * (wavelength - 440) / 50;
            } else if (wavelength <= 570) {
                wavelengthEffect = 0.5 + 0.2 * (570 - wavelength) / 80;
            } else if (wavelength <= 620) {
                wavelengthEffect = 0.6 + 0.3 * (wavelength - 570) / 50;
            } else {
                wavelengthEffect = 0.8 + 0.2 * (700 - wavelength) / 80;
            }
            
            // åŸºç¡€å…‰åˆä½œç”¨é€Ÿç‡
            let photoRate = 12 * lightEffect * tempEffect * co2Effect * wavelengthEffect * phEffect;
            
            // æ·»åŠ ä¸€äº›éšæœºå˜å¼‚ï¼ˆÂ±8%ï¼‰
            photoRate *= 0.92 + Math.random() * 0.16;
            
            // ç¡®ä¿éè´Ÿ
            photoRate = Math.max(0, photoRate);
            
            // è®¡ç®—æ°§æ°”äº§ç”Ÿé€Ÿç‡å’ŒCOâ‚‚å¸æ”¶é€Ÿç‡
            const oxygenRate = photoRate * 22.4 * 3.6; // è½¬æ¢ä¸ºmL/h
            const co2Rate = photoRate; // Î¼mol/mÂ²/s
            
            return {
                photoRate: photoRate,
                oxygenRate: oxygenRate,
                co2Rate: co2Rate
            };
        }
        
        // å¼€å§‹å®éªŒ
        function startExperiment() {
            if (experimentGroups.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆå®éªŒè£…ç½®ï¼');
                return;
            }
            
            if (experimentRunning) {
                return;
            }
            
            experimentRunning = true;
            experimentTime = 0;
            recordedData = [];
            
            // æ›´æ–°å®éªŒæ—¶é•¿
            maxExperimentTime = parseInt(document.getElementById('experimentDuration').value) * 60;
            
            // é‡ç½®å®éªŒç»„æ•°æ®
            experimentGroups.forEach(group => {
                group.timeData = [];
                group.o2ConcentrationData = [];
                group.co2ConcentrationData = [];
                group.oxygenRateData = [];
                group.co2RateData = [];
                group.currentO2Concentration = group.initialO2Concentration;
                group.currentCO2Concentration = group.initialCO2Concentration;
                group.oxygenRate = 0;
                group.co2Rate = 0;
            });
            
            // åˆå§‹åŒ–å®æ—¶å›¾è¡¨
            initRealTimeChart();
            
            // å¼€å§‹è®¡æ—¶å™¨
            clearInterval(timeInterval);
            timeInterval = setInterval(updateExperiment, 1000 / simulationSpeed);
            
            // éšè—å ä½ç¬¦
            document.getElementById('realTimePlaceholder').style.display = 'none';
            
            // ç¦ç”¨å¼€å§‹æŒ‰é’®
            document.getElementById('startBtn').disabled = true;
        }
        
        // æ›´æ–°å®éªŒ
        function updateExperiment() {
            experimentTime += 1;
            
            // æ›´æ–°æ—¶é—´æ˜¾ç¤º
            const minutes = Math.floor(experimentTime / 60);
            const seconds = experimentTime % 60;
            document.getElementById('timeDisplay').textContent = 
                `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            
            // æ›´æ–°æ¯ç»„æ•°æ®
            experimentGroups.forEach(group => {
                // è®¡ç®—å½“å‰å…‰åˆä½œç”¨é€Ÿç‡
                const rates = calculatePhotosynthesisRates(group);
                group.oxygenRate = rates.oxygenRate;
                group.co2Rate = rates.co2Rate;
                
                // æ›´æ–°æ°”ä½“æµ“åº¦ï¼ˆç®€åŒ–æ¨¡å‹ï¼šæµ“åº¦å˜åŒ–ä¸é€Ÿç‡æˆæ­£æ¯”ï¼‰
                // å‡è®¾å¯†é—­å®¹å™¨ä½“ç§¯ä¸º1Lï¼Œæ°”ä½“æµ“åº¦å˜åŒ–å…¬å¼
                const timeFactor = 1 / 3600; // æ¯ç§’çš„å˜åŒ–
                
                // æ°§æ°”æµ“åº¦å¢åŠ ï¼ˆå…‰åˆä½œç”¨äº§ç”Ÿæ°§æ°”ï¼‰
                group.currentO2Concentration += (group.oxygenRate * 1000 / 22.4) * timeFactor;
                
                // COâ‚‚æµ“åº¦å‡å°‘ï¼ˆå…‰åˆä½œç”¨æ¶ˆè€—COâ‚‚ï¼‰
                group.currentCO2Concentration -= (group.co2Rate * 1000) * timeFactor;
                
                // ç¡®ä¿æµ“åº¦åœ¨åˆç†èŒƒå›´å†…
                group.currentO2Concentration = Math.max(200000, Math.min(250000, group.currentO2Concentration));
                group.currentCO2Concentration = Math.max(100, Math.min(2000, group.currentCO2Concentration));
                
                // è®°å½•æ•°æ®ç‚¹ï¼ˆæ¯5ç§’è®°å½•ä¸€æ¬¡ï¼‰
                if (experimentTime % 5 === 0) {
                    group.timeData.push(experimentTime);
                    group.o2ConcentrationData.push(group.currentO2Concentration);
                    group.co2ConcentrationData.push(group.currentCO2Concentration);
                    group.oxygenRateData.push(group.oxygenRate);
                    group.co2RateData.push(group.co2Rate);
                }
                
                // æ›´æ–°è£…ç½®è¯»æ•°
                const readingElement = document.getElementById(`reading${group.id}`);
                const dependentType = getDependentType();
                
                if (readingElement) {
                    switch(dependentType) {
                        case 'oxygen-concentration':
                            readingElement.textContent = group.currentO2Concentration.toFixed(0);
                            break;
                        case 'oxygen-rate':
                            readingElement.textContent = group.oxygenRate.toFixed(2);
                            break;
                        case 'co2-rate':
                            readingElement.textContent = group.co2Rate.toFixed(2);
                            break;
                    }
                }
                
                // æ›´æ–°æ°”æ³¡
                updateBubbles(group.id, group.oxygenRate);
            });
            
            // æ›´æ–°å®æ—¶å›¾è¡¨
            updateRealTimeChart();
            
            // å®éªŒè¾¾åˆ°è®¾å®šæ—¶é•¿æ—¶ç»“æŸ
            if (experimentTime >= maxExperimentTime) {
                clearInterval(timeInterval);
                experimentRunning = false;
                document.getElementById('startBtn').disabled = false;
                alert('å®éªŒå·²å®Œæˆï¼å¯ä»¥æ•´ç†æ•°æ®è¿›è¡Œåˆ†æã€‚');
            }
        }
        
        // æ›´æ–°æ°”æ³¡
        function updateBubbles(groupId, oxygenRate) {
            const bubblesContainer = document.getElementById(`bubbles${groupId}`);
            if (!bubblesContainer) return;
            
            // æ¸…ç©ºæ°”æ³¡
            bubblesContainer.innerHTML = '';
            
            // æ ¹æ®æ°§æ°”äº§ç”Ÿé€Ÿç‡ç”Ÿæˆæ°”æ³¡æ•°é‡
            const bubbleCount = Math.min(15, Math.floor(oxygenRate / 10));
            
            for (let i = 0; i < bubbleCount; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                bubble.style.left = `${30 + Math.random() * 40}%`;
                bubble.style.animationDuration = `${1 + Math.random() * 2}s`;
                bubble.style.animationDelay = `${Math.random() * 2}s`;
                bubble.style.width = `${8 + Math.random() * 8}px`;
                bubble.style.height = bubble.style.width;
                bubblesContainer.appendChild(bubble);
            }
        }
        
        // åˆå§‹åŒ–å®æ—¶å›¾è¡¨
        function initRealTimeChart() {
            const ctx = document.getElementById('realTimeChart').getContext('2d');
            
            if (realTimeChart) {
                realTimeChart.destroy();
            }
            
            const datasets = experimentGroups.map((group, index) => ({
                label: `å®éªŒç»„ ${group.id}`,
                data: [],
                borderColor: chartColors[index % chartColors.length],
                backgroundColor: chartColors[index % chartColors.length] + '20',
                borderWidth: 3,
                fill: false,
                tension: 0.4,
                pointRadius: 3,
                pointHoverRadius: 7,
                pointBackgroundColor: chartColors[index % chartColors.length]
            }));
            
            realTimeChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'æ—¶é—´ (ç§’)',
                                font: {
                                    size: 18, // å¢å¤§å­—ä½“å¤§å°
                                    weight: 'bold',
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                                },
                                color: '#1e7e34', // åŠ æ·±é¢œè‰²
                                padding: {top: 15, bottom: 15} // å¢åŠ å†…è¾¹è·
                            },
                            min: 0,
                            max: maxExperimentTime,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.08)',
                                drawBorder: true,
                                borderColor: 'rgba(0, 0, 0, 0.15)'
                            },
                            ticks: {
                                color: '#333', // åŠ æ·±é¢œè‰²
                                font: {
                                    size: 16, // å¢å¤§å­—ä½“å¤§å°
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                    weight: '500'
                                },
                                padding: 10
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: getDependentName() + ' (' + getDependentUnit() + ')',
                                font: {
                                    size: 18, // å¢å¤§å­—ä½“å¤§å°
                                    weight: 'bold',
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                                },
                                color: '#1e7e34', // åŠ æ·±é¢œè‰²
                                padding: {top: 15, bottom: 15} // å¢åŠ å†…è¾¹è·
                            },
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.08)',
                                drawBorder: true,
                                borderColor: 'rgba(0, 0, 0, 0.15)'
                            },
                            ticks: {
                                color: '#333', // åŠ æ·±é¢œè‰²
                                font: {
                                    size: 16, // å¢å¤§å­—ä½“å¤§å°
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                    weight: '500'
                                },
                                padding: 10
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // æˆ‘ä»¬å°†ä½¿ç”¨è‡ªå®šä¹‰å›¾ä¾‹
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(255, 255, 255, 0.97)',
                            titleColor: '#1e7e34',
                            bodyColor: '#333',
                            borderColor: '#c8e6c9',
                            borderWidth: 2,
                            boxPadding: 5,
                            titleFont: {
                                size: 14,
                                family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14,
                                family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                            },
                            padding: 12
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'nearest'
                    },
                    animation: {
                        duration: 500
                    }
                }
            });
            
            // åˆ›å»ºè‡ªå®šä¹‰å›¾ä¾‹
            updateLegend();
        }
        
        // æ›´æ–°è‡ªå®šä¹‰å›¾ä¾‹
        function updateLegend() {
            const legendContainer = document.getElementById('realTimeLegend');
            if (!legendContainer) return;
            
            let legendHTML = '';
            experimentGroups.forEach((group, index) => {
                const independentVar = group.independentVar;
                const independentValue = group.independentValue;
                const varName = getVarName(independentVar);
                const varUnit = getVarUnit(independentVar);
                
                legendHTML += `
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: ${chartColors[index % chartColors.length]}"></div>
                        <span>ç»„${group.id}: ${varName}=${independentValue}${varUnit}</span>
                    </div>
                `;
            });
            
            legendContainer.innerHTML = legendHTML;
        }
        
        // æ›´æ–°å®æ—¶å›¾è¡¨
        function updateRealTimeChart() {
            if (!realTimeChart) return;
            
            // æ›´æ–°xè½´æ ‡ç­¾ï¼ˆåªä¿ç•™æœ€è¿‘çš„ç‚¹ï¼‰
            const timeLabels = experimentGroups[0].timeData.map(t => t.toString());
            realTimeChart.data.labels = timeLabels;
            
            // æ ¹æ®åº”å˜é‡ç±»å‹æ›´æ–°æ•°æ®
            const dependentType = getDependentType();
            
            experimentGroups.forEach((group, index) => {
                switch(dependentType) {
                    case 'oxygen-concentration':
                        realTimeChart.data.datasets[index].data = group.o2ConcentrationData;
                        break;
                    case 'oxygen-rate':
                        realTimeChart.data.datasets[index].data = group.oxygenRateData;
                        break;
                    case 'co2-rate':
                        realTimeChart.data.datasets[index].data = group.co2RateData;
                        break;
                }
            });
            
            realTimeChart.update('none');
        }
        
        // æ•°æ®æ•´ç†ï¼ˆåŸè®°å½•æ•°æ®ï¼‰
        function recordData() {
            if (experimentGroups.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆå®éªŒè£…ç½®å¹¶è¿è¡Œå®éªŒï¼');
                return;
            }
            
            // æ”¶é›†æ•°æ®
            const dataPoint = {
                independentVar: experimentGroups[0].independentVar,
                independentVarName: getVarName(experimentGroups[0].independentVar),
                dependentVarName: getDependentName(),
                dependentUnit: getDependentUnit(),
                dependentType: getDependentType(),
                groups: []
            };
            
            experimentGroups.forEach(group => {
                // å–æœ€å10ç§’çš„å¹³å‡å€¼ä½œä¸ºç¨³å®šå€¼
                let avgValue;
                const dependentType = getDependentType();
                
                switch(dependentType) {
                    case 'oxygen-concentration':
                        const recentO2 = group.o2ConcentrationData.slice(-2);
                        avgValue = recentO2.length > 0 ? 
                            recentO2.reduce((a, b) => a + b, 0) / recentO2.length : 
                            group.currentO2Concentration;
                        break;
                    case 'oxygen-rate':
                        const recentO2Rate = group.oxygenRateData.slice(-2);
                        avgValue = recentO2Rate.length > 0 ? 
                            recentO2Rate.reduce((a, b) => a + b, 0) / recentO2Rate.length : 
                            group.oxygenRate;
                        break;
                    case 'co2-rate':
                        const recentCO2Rate = group.co2RateData.slice(-2);
                        avgValue = recentCO2Rate.length > 0 ? 
                            recentCO2Rate.reduce((a, b) => a + b, 0) / recentCO2Rate.length : 
                            group.co2Rate;
                        break;
                    default:
                        avgValue = 0;
                }
                
                dataPoint.groups.push({
                    id: group.id,
                    independentValue: group.independentValue,
                    dependentValue: avgValue
                });
            });
            
            recordedData.push(dataPoint);
            
            // æ›´æ–°æŸ±çŠ¶å›¾
            updateBarChart();
            
            // å¦‚æœå®éªŒç»„æ•°â‰¥5ï¼Œæ›´æ–°æŠ˜çº¿å›¾
            if (experimentGroups.length >= 5) {
                updateLineChart();
                document.getElementById('lineChartSection').style.display = 'block';
            }
            
            // éšè—æŸ±çŠ¶å›¾å ä½ç¬¦
            document.getElementById('barChartPlaceholder').style.display = 'none';
            
            // å¯ç”¨å¼€å§‹æŒ‰é’®
            document.getElementById('startBtn').disabled = false;
            
            alert(`å·²æ•´ç†ç¬¬${recordedData.length}ç»„æ•°æ®ï¼`);
        }
        
        // æ›´æ–°æŸ±çŠ¶å›¾
        function updateBarChart() {
            const ctx = document.getElementById('barChart').getContext('2d');
            
            if (barChart) {
                barChart.destroy();
            }
            
            // ä½¿ç”¨æœ€æ–°è®°å½•çš„æ•°æ®
            const latestData = recordedData[recordedData.length - 1];
            if (!latestData) return;
            
            // è®¡ç®—æ•°æ®çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œç”¨äºè°ƒæ•´çºµåæ ‡èŒƒå›´
            const values = latestData.groups.map(g => g.dependentValue);
            const minValue = Math.min(...values);
            const maxValue = Math.max(...values);
            const valueRange = maxValue - minValue;
            
            // æ ¹æ®åº”å˜é‡ç±»å‹å†³å®šçºµåæ ‡æ˜¯å¦ä»0å¼€å§‹
            let yBeginAtZero = true;
            let suggestedMin = 0;
            let suggestedMax = maxValue * 1.1; // é»˜è®¤æœ€å¤§å€¼å¢åŠ 10%
            
            // å¯¹äºæ°§æ°”æµ“åº¦ï¼Œä¸å¼ºåˆ¶ä»0å¼€å§‹ï¼Œä»¥å‡¸æ˜¾å·®å¼‚
            if (latestData.dependentType === 'oxygen-concentration') {
                yBeginAtZero = false;
                suggestedMin = minValue - (valueRange * 0.1); // æœ€å°å€¼å‡å°‘10%çš„èŒƒå›´
                suggestedMax = maxValue + (valueRange * 0.1); // æœ€å¤§å€¼å¢åŠ 10%çš„èŒƒå›´
                
                // ç¡®ä¿æœ€å°å€¼ä¸ä¼šä½äº0
                if (suggestedMin < 0) suggestedMin = 0;
            }
            
            barChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: latestData.groups.map(g => `ç»„${g.id}`),
                    datasets: [{
                        label: latestData.dependentVarName,
                        data: latestData.groups.map(g => g.dependentValue),
                        backgroundColor: chartColors.slice(0, latestData.groups.length).map(color => color + 'CC'),
                        borderColor: chartColors.slice(0, latestData.groups.length),
                        borderWidth: 2,
                        hoverBackgroundColor: chartColors.slice(0, latestData.groups.length),
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: yBeginAtZero,
                            suggestedMin: suggestedMin,
                            suggestedMax: suggestedMax,
                            title: {
                                display: true,
                                text: latestData.dependentVarName + latestData.dependentUnit,
                                font: {
                                    size: 18, // å¢å¤§å­—ä½“å¤§å°
                                    weight: 'bold',
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                                },
                                color: '#1e7e34', // åŠ æ·±é¢œè‰²
                                padding: {top: 15, bottom: 15} // å¢åŠ å†…è¾¹è·
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.08)',
                                drawBorder: true,
                                borderColor: 'rgba(0, 0, 0, 0.15)'
                            },
                            ticks: {
                                color: '#333', // åŠ æ·±é¢œè‰²
                                font: {
                                    size: 16, // å¢å¤§å­—ä½“å¤§å°
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                    weight: '500'
                                },
                                padding: 10,
                                callback: function(value) {
                                    // å¯¹äºå¤§æ•°å€¼ï¼Œä½¿ç”¨åƒä½åˆ†éš”ç¬¦
                                    if (value >= 1000) {
                                        return value.toLocaleString();
                                    }
                                    return value;
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'å®éªŒç»„',
                                font: {
                                    size: 18, // å¢å¤§å­—ä½“å¤§å°
                                    weight: 'bold',
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                                },
                                color: '#1e7e34', // åŠ æ·±é¢œè‰²
                                padding: {top: 15, bottom: 15} // å¢åŠ å†…è¾¹è·
                            },
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#333', // åŠ æ·±é¢œè‰²
                                font: {
                                    size: 16, // å¢å¤§å­—ä½“å¤§å°
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                    weight: '500'
                                },
                                padding: 10
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const groupIndex = context.dataIndex;
                                    const group = latestData.groups[groupIndex];
                                    const value = context.parsed.y;
                                    let formattedValue = value.toFixed(2);
                                    
                                    // å¯¹äºå¤§æ•°å€¼ï¼Œæ˜¾ç¤ºæ›´å‹å¥½çš„æ ¼å¼
                                    if (value >= 1000) {
                                        formattedValue = value.toLocaleString(undefined, {
                                            minimumFractionDigits: 0,
                                            maximumFractionDigits: 0
                                        });
                                    }
                                    
                                    return [
                                        `${latestData.independentVarName}: ${group.independentValue}${getVarUnit(latestData.independentVar)}`,
                                        `${latestData.dependentVarName}: ${formattedValue}${latestData.dependentUnit}`
                                    ];
                                }
                            },
                            backgroundColor: 'rgba(255, 255, 255, 0.97)',
                            titleColor: '#1e7e34',
                            bodyColor: '#333',
                            borderColor: '#c8e6c9',
                            borderWidth: 2,
                            boxPadding: 5,
                            titleFont: {
                                size: 14,
                                family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14,
                                family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                            },
                            padding: 12
                        }
                    },
                    // è°ƒæ•´æŸ±å­å®½åº¦ï¼ˆå˜ç»†ï¼‰
                    barPercentage: 0.65,
                    categoryPercentage: 0.75
                }
            });
        }
        
        // æ›´æ–°æŠ˜çº¿å›¾
        function updateLineChart() {
            const ctx = document.getElementById('lineChart').getContext('2d');
            
            if (lineChart) {
                lineChart.destroy();
            }
            
            // ä½¿ç”¨æœ€æ–°è®°å½•çš„æ•°æ®
            const latestData = recordedData[recordedData.length - 1];
            if (!latestData) return;
            
            // æŒ‰è‡ªå˜é‡å€¼æ’åº
            const sortedGroups = [...latestData.groups].sort((a, b) => a.independentValue - b.independentValue);
            
            lineChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: sortedGroups.map(g => g.independentValue.toString() + getVarUnit(latestData.independentVar)),
                    datasets: [{
                        label: latestData.dependentVarName,
                        data: sortedGroups.map(g => g.dependentValue),
                        borderColor: '#34a853',
                        backgroundColor: 'rgba(52, 168, 83, 0.1)',
                        borderWidth: 4,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: sortedGroups.map((g, i) => chartColors[i % chartColors.length]),
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        pointRadius: 8,
                        pointHoverRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: latestData.dependentVarName + latestData.dependentUnit,
                                font: {
                                    size: 18, // å¢å¤§å­—ä½“å¤§å°
                                    weight: 'bold',
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                                },
                                color: '#1e7e34', // åŠ æ·±é¢œè‰²
                                padding: {top: 15, bottom: 15} // å¢åŠ å†…è¾¹è·
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.08)',
                                drawBorder: true,
                                borderColor: 'rgba(0, 0, 0, 0.15)'
                            },
                            ticks: {
                                color: '#333', // åŠ æ·±é¢œè‰²
                                font: {
                                    size: 16, // å¢å¤§å­—ä½“å¤§å°
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                    weight: '500'
                                },
                                padding: 10
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: latestData.independentVarName + ' (' + getVarUnit(latestData.independentVar) + ')',
                                font: {
                                    size: 18, // å¢å¤§å­—ä½“å¤§å°
                                    weight: 'bold',
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                                },
                                color: '#1e7e34', // åŠ æ·±é¢œè‰²
                                padding: {top: 15, bottom: 15} // å¢åŠ å†…è¾¹è·
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.08)',
                                drawBorder: true,
                                borderColor: 'rgba(0, 0, 0, 0.15)'
                            },
                            ticks: {
                                color: '#333', // åŠ æ·±é¢œè‰²
                                font: {
                                    size: 16, // å¢å¤§å­—ä½“å¤§å°
                                    family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                    weight: '500'
                                },
                                padding: 10
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${latestData.dependentVarName}: ${context.parsed.y.toFixed(2)}${latestData.dependentUnit}`;
                                }
                            },
                            backgroundColor: 'rgba(255, 255, 255, 0.97)',
                            titleColor: '#1e7e34',
                            bodyColor: '#333',
                            borderColor: '#c8e6c9',
                            borderWidth: 2,
                            boxPadding: 5,
                            titleFont: {
                                size: 14,
                                family: "'Segoe UI', 'Microsoft YaHei', sans-serif",
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14,
                                family: "'Segoe UI', 'Microsoft YaHei', sans-serif"
                            },
                            padding: 12
                        }
                    }
                }
            });
            
            // éšè—æŠ˜çº¿å›¾å ä½ç¬¦
            document.getElementById('lineChartPlaceholder').style.display = 'none';
        }
        
        // æ”¹å˜æ¨¡æ‹Ÿé€Ÿåº¦
        function changeSpeed() {
            simulationSpeed = parseInt(document.getElementById('speedControl').value);
            
            if (experimentRunning) {
                clearInterval(timeInterval);
                timeInterval = setInterval(updateExperiment, 1000 / simulationSpeed);
            }
        }
        
        // é‡ç½®å®éªŒ
        function resetExperiment() {
            clearInterval(timeInterval);
            experimentRunning = false;
            experimentTime = 0;
            experimentGroups = [];
            recordedData = [];
            
            document.getElementById('timeDisplay').textContent = '0:00';
            document.getElementById('apparatusSection').style.display = 'none';
            document.getElementById('startBtn').disabled = false;
            document.getElementById('recordBtn').disabled = true;
            
            // æ˜¾ç¤ºå ä½ç¬¦
            document.getElementById('realTimePlaceholder').style.display = 'flex';
            document.getElementById('barChartPlaceholder').style.display = 'flex';
            document.getElementById('lineChartPlaceholder').style.display = 'flex';
            document.getElementById('lineChartSection').style.display = 'none';
            
            // æ¸…é™¤å›¾ä¾‹
            document.getElementById('realTimeLegend').innerHTML = '';
            
            // æ¸…é™¤å›¾è¡¨
            if (realTimeChart) {
                realTimeChart.destroy();
                realTimeChart = null;
            }
            
            if (barChart) {
                barChart.destroy();
                barChart = null;
            }
            
            if (lineChart) {
                lineChart.destroy();
                lineChart = null;
            }
            
            alert('å®éªŒå·²é‡ç½®ï¼');
        }
        
        // ç›‘å¬è‡ªå˜é‡å˜åŒ–
        document.getElementById('independentVar').addEventListener('change', function() {
            generateParamInputs();
            document.getElementById('apparatusSection').style.display = 'none';
            document.getElementById('recordBtn').disabled = true;
            document.getElementById('startBtn').disabled = true;
            document.getElementById('lineChartSection').style.display = 'none';
        });
        
        // ç›‘å¬å®éªŒç»„æ•°å˜åŒ–
        document.getElementById('groupCount').addEventListener('change', generateParamInputs);
        
        // ç›‘å¬æ³¢é•¿å‚æ•°å˜åŒ–
        document.addEventListener('input', function(e) {
            if (e.target.id.startsWith('param') && document.getElementById('independentVar').value === 'wavelength') {
                updateWavelengthColors();
            }
        });
    </script>
</body>
</html>